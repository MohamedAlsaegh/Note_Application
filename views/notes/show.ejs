<%- include('../partials/navbar') %>

<div class="main">
  <div class="note">
    <form action="/notes" method="POST">
      <input type="hidden" name="userId" value="<%= user._id %>" />
      <input type="text" name="title" placeholder="Title" required />

      <textarea
        name="content"
        placeholder="Content"
        rows="4"
        required
      ></textarea>

      <select name="tag" required>
        <% allTags.forEach(tag => { %>
        <option value="<%= tag %>"><%= tag %></option>
        <% }) %>
      </select>

      <input type="hidden" name="userId" value="<%= user._id %>" />
      <button type="submit">Add</button>
    </form>
  </div>

  <div class="notes-by-tag">
    <% taggedNotes.forEach(section => { %>
    <div class="tag-box">
      <h3><%= section.tag %></h3>

      <% if (section.notes.length > 0) { %>
      <ul>
        <% section.notes.forEach(note => { %>
        <li>
          <a href="/notes/<%= note._id %>/edit" class="note-title-link">
            <%= note.title %>
          </a>
        </li>
        <% }) %>
      </ul>
      <% } else { %>
      <p>No notes under this tag yet.</p>
      <% } %>
    </div>
    <% }) %>
  </div>
</div>
